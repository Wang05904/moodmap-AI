// test/sentiment.test.js
const { analyzeSentiment } = require('../utils/sentimentAl');

// æ¨¡æ‹Ÿå»¶è¿Ÿï¼Œé¿å…é¢‘ç¹è°ƒç”¨
jest.setTimeout(10000);

describe('æƒ…ç»ªåˆ†æžæ¨¡å—æµ‹è¯•', () => {
  test('æ­£é¢æƒ…ç»ªåº”è¿”å›ž 4 æˆ– 5', async () => {
    const result = await analyzeSentiment('ä»Šå¤©å¤©æ°”çœŸå¥½ï¼Œæˆ‘å¥½å¼€å¿ƒå•Šï¼');
    expect(result).toBeGreaterThanOrEqual(4);
  });

  test('è´Ÿé¢æƒ…ç»ªåº”è¿”å›ž 1 æˆ– 2', async () => {
    const result = await analyzeSentiment('å¥½ç´¯å•Šï¼Œä»€ä¹ˆéƒ½ä¸æƒ³åšï¼Œå¿ƒæƒ…å¾ˆå·®ã€‚');
    expect(result).toBeLessThanOrEqual(2);
  });

  test('ä¸­æ€§æƒ…ç»ªåº”è¿”å›ž 3', async () => {
    const result = await analyzeSentiment('ä»Šå¤©ä¸Šç­äº†ï¼Œåƒäº†åˆé¥­ã€‚');
    expect(result).toBe(3);
  });

  test('å«è¡¨æƒ…ç¬¦å·çš„æ–‡æœ¬ä¹Ÿèƒ½æ­£ç¡®åˆ†æž', async () => {
    const result = await analyzeSentiment('ç»ˆäºŽæ”¾å‡å•¦ ðŸ˜Š å¤ªå¼€å¿ƒäº†ï¼');
    expect(result).toBe(5);
  });

  test('é•¿æ–‡æœ¬ä¹Ÿèƒ½å¤„ç†', async () => {
    const longText = 'æœ€è¿‘å·¥ä½œåŽ‹åŠ›å¾ˆå¤§ï¼Œé¡¹ç›®è¿›åº¦ç´§å¼ ï¼Œæ¯å¤©åŠ ç­åˆ°å¾ˆæ™šï¼Œæ„Ÿè§‰èº«å¿ƒä¿±ç–²...ä½†å‘¨æœ«å’Œæœ‹å‹åŽ»çˆ¬å±±ï¼Œå‘¼å¸æ–°é²œç©ºæ°”ï¼Œå¿ƒæƒ…ç¨å¾®å¥½äº†ä¸€äº›ã€‚';
    const result = await analyzeSentiment(longText);
    expect([1, 2, 3]).toContain(result); // å¯èƒ½åè´Ÿé¢æˆ–ä¸­æ€§
  });

  test('ç©ºæ–‡æœ¬æˆ–æ— æ•ˆè¾“å…¥è¿”å›žé»˜è®¤å€¼ 3', async () => {
    const result = await analyzeSentiment('');
    expect(result).toBe(3);
  });
});
